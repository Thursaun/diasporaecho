import{g as S,s as F,j as e}from"./index-Bwu9_YO4.js";import{b as a,L as $}from"./vendor-DkSc4EIR.js";import{F as C}from"./FigureCard-CPihsJMl.js";import{L as _}from"./LazyFigureCard-sgNJCLXp.js";function W({onSaveFigureClick:v,onLikeFigureClick:M,savedFigures:u,onLoginClick:T,currentUser:N}){const[c,m]=a.useState([]),[t,V]=a.useState(""),[p,d]=a.useState(!1),[b,D]=a.useState(null),[g,h]=a.useState([]),[U,j]=a.useState(!0),l=a.useRef(null),k=a.useMemo(()=>{if(!u||!Array.isArray(u))return new Map;const s=new Map;return u.forEach(n=>{const o=n.wikipediaId||n._id;o&&s.set(o,!0)}),s},[u]),y=a.useCallback(s=>{if(!s)return!1;const n=s.wikipediaId||s._id;return k.has(n)},[k]),E=a.useCallback(s=>!s||!N?!1:(s.likedBy||[]).includes(N._id),[N]),w=a.useCallback(async s=>{const n=s._id||s.wikipediaId;console.log(`ðŸŽ¯ Main handleLikeClick: ${s.name} (current likes: ${s.likes})`),h(o=>o.map(i=>(i._id||i.wikipediaId)===n?{...i,likes:(i.likes||0)+1}:i)),m(o=>o.map(i=>(i._id||i.wikipediaId)===n?{...i,likes:(i.likes||0)+1}:i));try{const o=await M(s);console.log(`âœ… Server like successful for ${s.name}, new count: ${o.likes}`),h(i=>i.map(r=>(r._id||r.wikipediaId)===n?{...r,likes:o.likes,likedBy:o.likedBy}:r)),m(i=>i.map(r=>(r._id||r.wikipediaId)===n?{...r,likes:o.likes,likedBy:o.likedBy}:r))}catch(o){console.error("âŒ Like action failed:",o),h(i=>i.map(r=>(r._id||r.wikipediaId)===n?{...r,likes:(r.likes||1)-1}:r)),m(i=>i.map(r=>(r._id||r.wikipediaId)===n?{...r,likes:(r.likes||1)-1}:r))}},[M]),I=a.useMemo(()=>g,[g]);a.useEffect(()=>{j(!0),S().then(s=>{console.log("âœ… Featured figures loaded:",s.length),h(s),j(!1),s.slice(0,3).forEach((n,o)=>{const i=document.createElement("link");i.rel="preload",i.as="image",i.href=n.imageUrl,i.fetchPriority=o===0?"high":"low",document.head.appendChild(i)})}).catch(s=>{console.error("âŒ Error fetching featured figures:",s),j(!1)})},[]);const x=a.useCallback(s=>{if(!s||s.trim().length<2){m([]);return}d(!0),D(null),F({query:s}).then(n=>{console.log("Search results:",n),m(n),d(!1)}).catch(n=>{console.error("Error fetching search results:",n),D("Failed to fetch search results. Please try again."),d(!1)})},[]);a.useEffect(()=>(l.current&&clearTimeout(l.current),t&&t.trim().length>=2?l.current=setTimeout(()=>{x(t)},300):t||(m([]),d(!1)),()=>{l.current&&clearTimeout(l.current)}),[t,x]);const L=a.useCallback(s=>{s.preventDefault(),l.current&&clearTimeout(l.current),x(t)},[t,x]);return e.jsxDEV("main",{className:"min-h-screen bg-gray-50",children:[e.jsxDEV("section",{className:"bg-secondary text-white py-4 sm:py-6",children:e.jsxDEV("div",{className:"container mx-auto px-4 text-center",children:e.jsxDEV("form",{onSubmit:L,className:"flex flex-col sm:flex-row gap-3 max-w-2xl mx-auto",children:[e.jsxDEV("input",{type:"text",placeholder:"Search for historical figures...",className:"flex-grow p-3 sm:p-4 rounded-lg text-black text-base sm:text-lg focus:outline-none focus:ring-2 focus:ring-white/30",value:t,onChange:s=>V(s.target.value)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:215,columnNumber:13},this),e.jsxDEV("button",{type:"submit",className:"bg-dark text-white px-6 sm:px-8 py-3 sm:py-4 rounded-lg hover:bg-opacity-90 transition duration-300 font-semibold text-base sm:text-lg min-h-[44px]",disabled:p,children:p?"Searching...":"Search"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:222,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:211,columnNumber:11},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:210,columnNumber:9},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:209,columnNumber:7},this),e.jsxDEV("section",{className:`bg-white transition-all duration-500 ${t?"py-4 sm:py-6":"py-8 sm:py-12 lg:py-16"}`,children:e.jsxDEV("div",{className:"container mx-auto px-4",children:[e.jsxDEV("div",{className:`text-center transition-all duration-500 ${t?"mb-3 sm:mb-4":"mb-6 sm:mb-8 lg:mb-12"}`,children:[e.jsxDEV("h2",{className:`font-bold text-gray-900 transition-all duration-500 ${t?"text-base sm:text-lg md:text-xl mb-1 sm:mb-2":"text-2xl sm:text-3xl md:text-4xl mb-3 sm:mb-4"}`,children:"Featured Figures"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:236,columnNumber:13},this),e.jsxDEV("div",{className:`bg-gradient-to-r from-secondary to-primary mx-auto transition-all duration-500 ${t?"w-16 sm:w-20 h-px mb-1 sm:mb-2":"w-48 sm:w-64 md:w-72 h-1 mb-3 sm:mb-4"}`},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:239,columnNumber:13},this),!t&&e.jsxDEV("p",{className:"text-sm sm:text-base lg:text-lg text-gray-600 max-w-2xl mx-auto px-4",children:"Discover the most celebrated figures whose stories continue to inspire and educate"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:241,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:235,columnNumber:11},this),U?e.jsxDEV("div",{className:"flex justify-center items-center py-12",children:e.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-secondary"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:249,columnNumber:15},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:248,columnNumber:13},this):e.jsxDEV("div",{className:`grid transition-all duration-500 ${t?"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8"}`,children:I.map((s,n)=>e.jsxDEV("div",{className:`transform transition-all duration-300 ${t?"":"hover:scale-105"} mx-auto w-full max-w-sm`,children:e.jsxDEV("div",{className:"relative",children:[!t&&n<3&&e.jsxDEV("div",{className:"absolute -top-2 -right-2 z-10",children:e.jsxDEV("div",{className:`px-3 py-1 rounded-full text-white text-xs font-bold shadow-lg ${n===0?"bg-yellow-500":n===1?"bg-gray-400":"bg-orange-500"}`,children:n===0?"ðŸ¥‡ Most Liked":n===1?"ðŸ¥ˆ Popular":"ðŸ¥‰ Featured"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:267,columnNumber:25},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:266,columnNumber:23},this),e.jsxDEV(C,{figure:s,onLikeFigureClick:w,onSaveFigureClick:v,onLoginClick:T,isSaved:y(s),isLiked:E(s),priority:!0},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:278,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:264,columnNumber:19},this)},s._id,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:258,columnNumber:17},this))},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:252,columnNumber:13},this),!t&&e.jsxDEV("div",{className:"text-center mt-8 sm:mt-12",children:e.jsxDEV($,{to:"/echoes",className:"inline-flex items-center px-6 sm:px-8 py-3 sm:py-4 bg-secondary text-white rounded-lg hover:bg-opacity-90 transition duration-300 font-semibold text-base sm:text-lg min-h-[44px]",children:["Explore All Figures",e.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2",children:[e.jsxDEV("path",{d:"M5 12h14"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:301,columnNumber:19},this),e.jsxDEV("path",{d:"M12 5l7 7-7 7"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:302,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:300,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:295,columnNumber:15},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:294,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:234,columnNumber:9},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:233,columnNumber:7},this),t&&e.jsxDEV("section",{className:"py-4 sm:py-6 bg-gray-50",children:e.jsxDEV("div",{className:"container mx-auto px-4",children:[e.jsxDEV("div",{className:"mb-4 sm:mb-6",children:[e.jsxDEV("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-1 sm:mb-2",children:"Search Results"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:314,columnNumber:15},this),e.jsxDEV("p",{className:"text-xs sm:text-sm text-gray-600",children:c.length>0?`Found ${c.length} result${c.length!==1?"s":""} for "${t}"`:`Searching for "${t}"...`},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:317,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:313,columnNumber:13},this),p&&e.jsxDEV("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-secondary mb-4"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:327,columnNumber:17},this),e.jsxDEV("p",{className:"text-gray-500",children:"Searching through our collection..."},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:328,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:326,columnNumber:15},this),b&&e.jsxDEV("div",{className:"text-center py-12",children:e.jsxDEV("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto text-red-500 mb-4",children:[e.jsxDEV("circle",{cx:"12",cy:"12",r:"10"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:336,columnNumber:21},this),e.jsxDEV("line",{x1:"15",y1:"9",x2:"9",y2:"15"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:337,columnNumber:21},this),e.jsxDEV("line",{x1:"9",y1:"9",x2:"15",y2:"15"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:338,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:335,columnNumber:19},this),e.jsxDEV("p",{className:"text-red-600 font-medium",children:b},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:340,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:334,columnNumber:17},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:333,columnNumber:15},this),c.length===0&&!p&&!b&&t&&e.jsxDEV("div",{className:"text-center py-12",children:e.jsxDEV("div",{className:"bg-gray-100 rounded-lg p-8 max-w-md mx-auto",children:[e.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto text-gray-400 mb-4",children:[e.jsxDEV("circle",{cx:"11",cy:"11",r:"8"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:349,columnNumber:21},this),e.jsxDEV("path",{d:"M21 21l-4.35-4.35"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:350,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:348,columnNumber:19},this),e.jsxDEV("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No results found"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:352,columnNumber:19},this),e.jsxDEV("p",{className:"text-gray-600 mb-4",children:['No results found for "',e.jsxDEV("span",{className:"font-medium",children:t},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:354,columnNumber:48},this),'"']},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:353,columnNumber:19},this),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Try different keywords or explore our featured figures above"},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:356,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:347,columnNumber:17},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:346,columnNumber:15},this),c.length>0&&!p&&e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:c.map(s=>e.jsxDEV("div",{className:"mx-auto w-full max-w-sm",children:e.jsxDEV(_,{figure:s,onLikeFigureClick:w,onSaveFigureClick:v,onLoginClick:T,isSaved:y(s),isLiked:E(s)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:367,columnNumber:21},this)},s.wikipediaId||s._id||`temp-${Date.now()}`,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:366,columnNumber:19},this))},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:364,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:312,columnNumber:11},this)},void 0,!1,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:311,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/peanut/Development/TripleTen/projects/diasporaecho/client/src/components/Main/Main.jsx",lineNumber:208,columnNumber:5},this)}export{W as default};
